(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{5511:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/register",function(){return a(794)}])},7476:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(4370).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},2608:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(4370).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},794:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSP:function(){return k},default:function(){return N}});var r=a(5893),s=a(7294),l=a(9008),n=a.n(l),i=a(5675),o=a.n(i),c=a(4370);let d=(0,c.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var u=a(7476),m=a(2608);let p=(0,c.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var h=a(1065),x=a(9451),g=a(6100),f=a(6650),v=a(4309),w=a(1163),y=a(7421);let b=()=>(0,r.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",children:[(0,r.jsx)("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),(0,r.jsx)("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),(0,r.jsx)("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),(0,r.jsx)("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C42.021,35.596,44,30.138,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),j=e=>{let{icon:t,...a}=e;return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t}),(0,r.jsx)("input",{...a,className:"w-full bg-slate-800 border border-slate-700 rounded-md pl-10 pr-4 py-2 focus:ring-pink-500 focus:border-pink-500 transition"})]})},_=e=>{let{label:t,...a}=e;return(0,r.jsxs)("label",{className:"flex items-center gap-3 text-sm text-slate-400 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",...a,className:"w-4 h-4 bg-slate-700 border-slate-600 rounded text-pink-500 focus:ring-pink-500"}),t]})};var k=!0;function N(e){let{onLoginClick:t,onRegisterClick:a}=e,{t:l}=(0,y.$G)("common"),{refreshUser:i}=(0,v.aC)(),c=(0,w.useRouter)(),[k,N]=(0,s.useState)({firstname:"",lastname:"",company:"",email:"",password:"",confirmPassword:"",avatarFile:null,previewAvatarUrl:""}),[C,F]=(0,s.useState)(""),[M,z]=(0,s.useState)(!1),U=e=>{N({...k,[e.target.name]:e.target.value})},E=async(e,t)=>{let a=(0,g.JU)(h.db,"users",e.uid),r=e.photoURL||null;if(t.avatarFile){z(!0);try{let a=(0,f.iH)(h.tO,"avatars/".concat(e.uid,"/").concat(t.avatarFile.name)),s=await (0,f.KV)(a,t.avatarFile);r=await (0,f.Jt)(s.ref),console.log("Avatar uploaded to:",r)}catch(e){throw console.error("Error uploading avatar during registration:",e),F("\xc9chec du t\xe9l\xe9chargement de l'avatar. Veuillez r\xe9essayer."),z(!1),e}}let s={uid:e.uid,email:e.email,displayName:e.displayName||"".concat(t.firstname||""," ").concat(t.lastname||"").trim(),photoURL:r,createdAt:new Date,firstname:t.firstname||"",lastname:t.lastname||"",company:t.company||""};try{await (0,g.pl)(a,s,{merge:!0}),console.log("User document created/updated in Firestore.")}catch(e){throw console.error("Error creating/updating user document in Firestore:",e),F("Erreur lors de la sauvegarde de votre profil. Veuillez r\xe9essayer."),e}},L=async e=>{if(e.preventDefault(),!M){if(k.password!==k.confirmPassword){F("Les mots de passe ne correspondent pas.");return}z(!0),F("");try{let e=await (0,x.Xb)(h.I8,k.email,k.password);console.log("Email registration successful for:",e.user.email),await E(e.user,{firstname:k.firstname,lastname:k.lastname,company:k.company,avatarFile:k.avatarFile}),i&&await i(e.user),t(),c.push("/dashboard")}catch(e){console.error("Email registration error:",e),"auth/email-already-in-use"===e.code?F(l("email_already_in_use","Cette adresse e-mail est d\xe9j\xe0 utilis\xe9e.")):"auth/weak-password"===e.code?F(l("weak_password","Le mot de passe doit contenir au moins 6 caract\xe8res.")):F(l("registration_error","Une erreur est survenue lors de l'inscription. Veuillez r\xe9essayer."))}finally{(!k.avatarFile||C)&&z(!1)}}},q=async()=>{if(M)return;z(!0),F("");let e=new x.hJ;try{let a=await (0,x.rh)(h.I8,e);console.log("Google Sign-In successful for:",a.user.email);let r=a.user.displayName?a.user.displayName.split(" "):["",""],s=r[0]||"",l=r.slice(1).join(" ")||"";await E(a.user,{firstname:s,lastname:l,company:"",avatarFile:k.avatarFile}),i&&await i(a.user),t(),c.push("/dashboard")}catch(e){console.error("Google Sign-In error:",e),"auth/popup-closed-by-user"===e.code?F(l("google_popup_closed","La fen\xeatre de connexion Google a \xe9t\xe9 ferm\xe9e.")):"auth/cancelled-popup-request"===e.code?F(l("google_request_cancelled","La requ\xeate de connexion Google a \xe9t\xe9 annul\xe9e.")):F(l("google_signin_error","Erreur lors de la connexion avec Google. Veuillez r\xe9essayer."))}finally{(!k.avatarFile||C)&&z(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n(),{children:(0,r.jsx)("title",{children:l("register_title","S'enregistrer")})}),(0,r.jsxs)("main",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-6 text-white text-center",children:l("register_page_headline","Inscrivez-vous pour d\xe9marrer !")}),(0,r.jsx)("p",{className:"text-xl text-slate-400 mb-8 text-center max-w-2xl",children:l("register_page_subheadline","Commencez votre exp\xe9rience NocaFLOW en cr\xe9ant votre compte.")}),(0,r.jsxs)("form",{onSubmit:L,className:"w-full max-w-md bg-slate-900/50 p-8 rounded-lg shadow-xl border border-slate-800 space-y-6",children:[C&&(0,r.jsx)("p",{className:"text-red-500 text-center mb-4",children:C}),(0,r.jsx)("div",{className:"flex justify-center space-x-4 mb-6",children:(0,r.jsxs)("button",{type:"button",onClick:q,className:"flex items-center justify-center gap-3 px-6 py-3 rounded-full bg-slate-700 hover:bg-slate-600 text-white font-semibold transition",children:[(0,r.jsx)(b,{})," ",l("register_with_google")]})}),(0,r.jsx)("div",{className:"text-center text-slate-400 mb-6",children:l("or_separator")}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(j,{type:"text",name:"firstname",placeholder:l("register_firstname"),value:k.firstname,onChange:U,icon:(0,r.jsx)(d,{className:"w-5 h-5 text-slate-400"}),required:!0}),(0,r.jsx)(j,{type:"text",name:"lastname",placeholder:l("register_lastname"),value:k.lastname,onChange:U,icon:(0,r.jsx)(d,{className:"w-5 h-5 text-slate-400"}),required:!0})]}),(0,r.jsx)(j,{type:"text",name:"company",placeholder:l("register_company"),value:k.company,onChange:U,icon:(0,r.jsx)(u.Z,{className:"w-5 h-5 text-slate-400"})}),(0,r.jsx)(j,{type:"email",name:"email",placeholder:l("login_email"),value:k.email,onChange:U,icon:(0,r.jsx)(m.Z,{className:"w-5 h-5 text-slate-400"}),required:!0}),(0,r.jsx)(j,{type:"password",name:"password",placeholder:l("login_password"),value:k.password,onChange:U,icon:(0,r.jsx)(p,{className:"w-5 h-5 text-slate-400"}),required:!0}),(0,r.jsx)(j,{type:"password",name:"confirmPassword",placeholder:l("register_confirm_password"),value:k.confirmPassword,onChange:U,icon:(0,r.jsx)(p,{className:"w-5 h-5 text-slate-400"}),required:!0}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-20 h-20 rounded-full bg-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0",children:k.previewAvatarUrl?(0,r.jsx)(o(),{src:k.previewAvatarUrl,alt:"Avatar Preview",width:80,height:80,objectFit:"cover"}):(0,r.jsx)(d,{className:"w-10 h-10 text-slate-400"})}),(0,r.jsxs)("label",{className:"flex-grow bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-md cursor-pointer text-center text-sm font-semibold transition",children:[l("register_avatar_upload"),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];N(e=>({...e,avatarFile:t,previewAvatarUrl:URL.createObjectURL(t)}))}else N(e=>({...e,avatarFile:null,previewAvatarUrl:""}))},className:"hidden"})]})]}),(0,r.jsx)(_,{label:l("checkbox_age","Je confirme avoir plus de 18 ans"),required:!0}),(0,r.jsx)(_,{label:l("checkbox_terms","J'ai lu et j'accepte les conditions d'utilisation"),required:!0}),(0,r.jsx)("button",{type:"submit",disabled:M,className:"w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed",children:M?l("registering","Inscription..."):l("register_button","Cr\xe9er mon compte")}),(0,r.jsxs)("p",{className:"text-center text-sm text-slate-400 mt-4",children:[l("already_account","D\xe9j\xe0 un compte ?")," "," ",(0,r.jsx)("button",{type:"button",onClick:t,className:"text-pink-500 hover:underline",children:l("login")})]})]})]})]})}}},function(e){e.O(0,[910,888,774,179],function(){return e(e.s=5511)}),_N_E=e.O()}]);